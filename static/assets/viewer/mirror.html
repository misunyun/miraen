<!DOCTYPE html>
<html lang="ko">

<head>
	<link rel="icon" href="/assets/viewer/img/favicon.ico" type="image/x-icon" />
	<meta charset="utf-8" />
	<meta content="width=1200" name="viewport" />
	<title>엠티처</title>

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vex-js@4.1.0/dist/css/vex.css"
		integrity="sha256-/eaLySG/rPCowjMWyStmTPGtaU79NKiqodgU2X/PJ/g=" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vex-js@4.1.0/dist/css/vex-theme-default.css"
		integrity="sha256-k8lNp1XCOztgAfpYiP1+lYwqY82ylXrl+Z5F176FscQ=" crossorigin="anonymous">


	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="css/video-js.css" />
	<link rel="stylesheet" type="text/css" href="css/viewer.module.css?d=20230121" />
	<link rel="stylesheet" type="text/css" href="css/viewer.css" />
	<link rel="stylesheet" type="text/css" href="css/viewer.custom.1.css" />
	<link rel="stylesheet" type="text/css" href="css/viewer.custom.2.css" />
	<link rel="stylesheet" type="text/css" href="css/viewer.custom.3.css" />
	<link rel="stylesheet" type="text/css" href="css/viewer.custom.4.css" />
	<link rel="stylesheet" type="text/css" href="css/mirror.css" />
</head>

<body theme="">
	<div id="viewer-wrap">
		<article id="viewer-content">
			<iframe id="iframe_content" src="" allowfullscreen></iframe>
			<div class="popup tools">
				<span class="title"></span>
				<a class="close"></a>
			</div>
			<div class="icon-prev-content" title="이전" style="display:none;"></div>
			<div class="icon-next-content" title="다음" style="display:none;"></div>

			<!-- module Start-->
			<div id="module-modal" data-backdrop="static" class="modal">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<div class="modal-tool-box">
								<span id="module-title"></span>
								<a class="carousel-control-prev" role="button" data-slide="prev" title="이전">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="sr-only">이전</span>
								</a>
								<span id="module-page">1 / 1</span>
								<a class="carousel-control-next" role="button" data-slide="next" title="다음">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="sr-only">다음</span>
								</a>
								<button type="button" id="download">다운로드</button>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
						</div>
						<div class="modal-body content">
							<div id="module-body"></div>
						</div>
					</div>
				</div>
			</div>
			<!-- module End-->

			<iframe id="iframe_content_pairbook" src="" allowfullscreen></iframe>
			<div id="iframe_tools_bg"></div>
			<iframe id="iframe_tools" src="" allowfullscreen></iframe>

			<div class="drawing-canvas-wrapper">
				<div class="drawing-canvas"></div>
			</div>

			<!-- ebook page move btn -->
			<div id="ebook_prev_btn" class="ebook_page_move_btn"></div>
			<div id="ebook_next_btn" class="ebook_page_move_btn"></div>
		</article>
		<article id="mirroring-start" class="d-flex align-items-center justify-content-center">
			<div class="mirroing-div p-2 bd-highlight col-example">
				<div class="animation">
					<img src="img/viewer/mirroing_animation.gif" />
				</div>
				<div class="description">
					<p>브라우저를 학생들이 볼 화면에 옮긴 후</p>
					<span class="shortcut">수업시작</span> 버튼을 눌러주세요.</p>
				</div>
				<div class="buttons">
					<a class="button">수업시작</a>
				</div>
			</div>
		</article>
	</div>

	<!-- 그리기 도구 -->
	<div id="drawing">
		<div>
			<button type="button" class="icon-drawing" title="그리기">그리기</button>
			<button type="button" class="icon-drawing2 active" title="텍스트 입력">텍스트 입력</button>
			<button type="button" class="icon-drawing3" title="도형 입력">도형 입력</button>
		</div>
		<!-- 그리기 색상, 선 굵기 선택 영역 -->
		<div id="palette">
			<button type="button" class="palette" data-color="#000000"><i style="background:#000000">색상1</i></button>
			<button type="button" class="palette" data-color="#ffffff"><i
					style="background:#fff; border-color:#d5d5d5">색상2</i></button>
			<button type="button" class="palette active" data-color="#f24545"><i
					style="background:#f24545">색상3</i></button>
			<button type="button" class="palette" data-color="#ff3be5"><i style="background:#ff3be5">색상4</i></button>
			<button type="button" class="palette" data-color="#2432cc"><i style="background:#2432cc">색상5</i></button>
			<button type="button" class="palette" data-color="#4090f3"><i style="background:#4090f3">색상6</i></button>
			<button type="button" class="palette" data-color="#4aedff"><i style="background:#4aedff">색상7</i></button>
			<button type="button" class="palette" data-color="#51e37f"><i style="background:#51e37f">색상8</i></button>
			<button type="button" class="palette" data-color="#ffd342"><i style="background:#ffd342">색상9</i></button>
			<button type="button" class="palette stroke_width" title="선 굵기"><i style="background : #d0d0d0">선
					굵기</i><span class="caret"></span></button>
			<div class="stroke_width_wrap">
				<button type="button" class="drawing_stroke_width" data-strokeWidth="30"><i>선굵기30</i></button>
				<button type="button" class="drawing_stroke_width" data-strokeWidth="24"><i
						class="active">선굵기24</i></button>
				<button type="button" class="drawing_stroke_width" data-strokeWidth="18"><i>선굵기18</i></button>
				<button type="button" class="drawing_stroke_width" data-strokeWidth="12"><i>선굵기12</i></button>
				<button type="button" class="drawing_stroke_width" data-strokeWidth="8"><i>선굵기8</i></button>
			</div>
		</div>
		<!-- 텍스트 폰트, 폰트 크기 선택 영역 -->
		<div id="font_select">
			<div id="font_family">
				<span class="ff_text">나눔고딕</span>
				<span class="caret"></span>
			</div>
			<div id="font_size">
				<span class="fs_text">70pt</span>
				<span class="caret"></span>
			</div>
			<button type="button" class="icon-font-lg"></button>
			<button type="button" class="icon-font-sm"></button>
			<button type="button" class="icon-font-color">
				<span class="fc_change"></span>
				<span class="caret"></span>
			</button>
			<!-- 폰트 패밀리 선택 -->
			<div class="font_family_wrap">
				<div class="select_f_fm select_font_family_1" data-font_family="NanumGothic">
					나눔고딕
				</div>
				<div class="select_f_fm select_font_family_2" data-font_family="NanumSquare">
					나눔스퀘어
				</div>
				<div class="select_f_fm select_font_family_3" data-font_family="NanumSquare_bold">나눔스퀘어 Bold
				</div>
				<div class="select_f_fm select_font_family_4" data-font_family="NanumMyeongjo">
					나눔명조
				</div>
			</div>
			<!-- 폰트 사이즈 선택 -->
			<div class="font_size_wrap">
				<div class="select_f_fs select_font_size_1" data-font_size="50">50pt
				</div>
				<div class="select_f_fs select_font_size_2" data-font_size="60">60pt
				</div>
				<div class="select_f_fs select_font_size_3" data-font_size="70">70pt
				</div>
				<div class="select_f_fs select_font_size_4" data-font_size="80">80pt
				</div>
				<div class="select_f_fs select_font_size_5" data-font_size="90">90pt
				</div>
				<div class="select_f_fs select_font_size_6" data-font_size="100">100pt
				</div>
			</div>
			<!-- 폰트 색상 선택 -->
			<div class="font_color_wrap">
				<button type="button" class="font_palette active" data-fontColor="#000000"><i style="background:#000000"
						class="active">색상1</i></button>
				<button type="button" class="font_palette" data-fontColor="#ffffff"><i
						style="background:#fff; border-color:#d5d5d5">색상2</i></button>
				<button type="button" class="font_palette" data-fontColor="#f24545"><i
						style="background:#f24545">색상3</i></button>
				<button type="button" class="font_palette" data-fontColor="#ff3be5"><i
						style="background:#ff3be5">색상4</i></button>
				<button type="button" class="font_palette" data-fontColor="#2432cc"><i
						style="background:#2432cc">색상5</i></button>
				<button type="button" class="font_palette" data-fontColor="#4090f3"><i
						style="background:#4090f3">색상6</i></button>
				<button type="button" class="font_palette" data-fontColor="#4aedff"><i
						style="background:#4aedff">색상7</i></button>
				<button type="button" class="font_palette" data-fontColor="#51e37f"><i
						style="background:#51e37f">색상8</i></button>
				<button type="button" class="font_palette" data-fontColor="#ffd342"><i
						style="background:#ffd342">색상9</i></button>
			</div>
		</div>
		<!-- 화살표, 직선, 형광펜, 스티커 영역 -->
		<div id="image_select">
			<button type="button" class="img_select icon-arrow"><i>화살표</i></button>
			<button type="button" class="img_select icon-line"><i>직선</i></button>
			<button type="button" class="img_select icon-hlighter"><i>형광펜</i></button>
			<button type="button" class="img_select icon-sticker"><i>스티커</i></button>
			<!-- 화살표 보조창 -->
			<div class="arrow_wrap">
				<button type="button" class="img_select icon-arrow-color"><i>컬러</i><span class="caret"></span></button>
				<button type="button" class="img_select icon-arrow-direction"><i>방향</i><span
						class="caret"></span></button>
				<button type="button" class="img_select icon-arrow-width"><i>굵기</i><span class="caret"></span></button>
				<button type="button" class="img_select icon-arrow-dash"><i>대시</i><span class="caret"></span></button>
				<!-- 화살표 컬러 -->
				<div class="arrow_color_wrap">
					<button type="button" class="arrow_palette" data-arrowColor="#000000"><i
							style="background:#000000">색상1</i></button>
					<button type="button" class="arrow_palette" data-arrowColor="#ffffff"><i
							style="background:#fff; border-color:#d5d5d5">색상2</i></button>
					<button type="button" class="arrow_palette active" data-arrowColor="#f24545">
						<i style="background:#f24545">색상3</i></button>
					<button type="button" class="arrow_palette" data-arrowColor="#ff3be5"><i
							style="background:#ff3be5">색상4</i></button>
					<button type="button" class="arrow_palette" data-arrowColor="#2432cc"><i
							style="background:#2432cc">색상5</i></button>
					<button type="button" class="arrow_palette" data-arrowColor="#4090f3"><i
							style="background:#4090f3">색상6</i></button>
					<button type="button" class="arrow_palette" data-arrowColor="#4aedff"><i
							style="background:#4aedff">색상7</i></button>
					<button type="button" class="arrow_palette" data-arrowColor="#51e37f"><i
							style="background:#51e37f">색상8</i></button>
					<button type="button" class="arrow_palette" data-arrowColor="#ffd342"><i
							style="background:#ffd342">색상9</i></button>
				</div>
				<!-- 화살표 방향 -->
				<div class="select_arrow_direction_wrap">
					<div class="select_a_d select_arrow_direction_1" data-direction="forward"></div>
					<div class="select_a_d select_arrow_direction_2" data-direction="reverse"></div>
					<div class="select_a_d select_arrow_direction_3" data-direction="bidirectional">
					</div>
				</div>
				<!-- 화살표 굵기 -->
				<div class="select_arrow_width_wrap">
					<div class="select_a_w select_arrow_width_1" data-arrow_width="2"></div>
					<div class="select_a_w select_arrow_width_2" data-arrow_width="4"></div>
					<div class="select_a_w select_arrow_width_3" data-arrow_width="6"></div>
					<div class="select_a_w select_arrow_width_4" data-arrow_width="8"></div>
					<div class="select_a_w select_arrow_width_5" data-arrow_width="10"></div>
				</div>
				<!-- 화살표 대시 -->
				<div class="select_arrow_dash_wrap">
					<div class="select_a_ds select_arrow_dash_1" data-arrow_dash="dash_1"></div>
					<div class="select_a_ds select_arrow_dash_2" data-arrow_dash="dash_2"></div>
					<div class="select_a_ds select_arrow_dash_3" data-arrow_dash="dash_3"></div>
				</div>
			</div>
			<!-- 직선 보조창 -->
			<div class="line_wrap">
				<button type="button" class="img_select icon-line-color"><i>컬러</i><span class="caret"></span></button>
				<button type="button" class="img_select icon-line-width"><i>굵기</i><span class="caret"></span></button>
				<button type="button" class="img_select icon-line-dash"><i>대시</i><span class="caret"></span></button>
				<!-- 직선 컬러 -->
				<div class="line_color_wrap">
					<button type="button" class="line_palette" data-lineColor="#000000"><i
							style="background:#000000">색상1</i></button>
					<button type="button" class="line_palette" data-lineColor="#ffffff"><i
							style="background:#fff; border-color:#d5d5d5">색상2</i></button>
					<button type="button" class="line_palette active" data-lineColor="#f24545"><i
							style="background:#f24545">색상3</i></button>
					<button type="button" class="line_palette" data-lineColor="#ff3be5"><i
							style="background:#ff3be5">색상4</i></button>
					<button type="button" class="line_palette" data-lineColor="#2432cc"><i
							style="background:#2432cc">색상5</i></button>
					<button type="button" class="line_palette" data-lineColor="#4090f3"><i
							style="background:#4090f3">색상6</i></button>
					<button type="button" class="line_palette" data-lineColor="#4aedff"><i
							style="background:#4aedff">색상7</i></button>
					<button type="button" class="line_palette" data-lineColor="#51e37f"><i
							style="background:#51e37f">색상8</i></button>
					<button type="button" class="line_palette" data-lineColor="#ffd342"><i
							style="background:#ffd342">색상9</i></button>
				</div>
				<!-- 직선 굵기 -->
				<div class="select_line_width_wrap">
					<div class="select_l_w select_line_width_1" data-line_width="2"></div>
					<div class="select_l_w select_line_width_2" data-line_width="4"></div>
					<div class="select_l_w select_line_width_3" data-line_width="6"></div>
					<div class="select_l_w select_line_width_4" data-line_width="8"></div>
					<div class="select_l_w select_line_width_5" data-line_width="10"></div>
				</div>
				<!-- 직선 대시 -->
				<div class="select_line_dash_wrap">
					<div class="select_l_ds select_line_dash_1" data-line_dash="dash_1"></div>
					<div class="select_l_ds select_line_dash_2" data-line_dash="dash_2"></div>
					<div class="select_l_ds select_line_dash_3" data-line_dash="dash_3"></div>
				</div>
			</div>
			<!-- 형광펜 보조창 -->
			<div class="hlighter_wrap">
				<button type="button" class="img_select icon-hlighter-color"><i>색상</i><span
						class="caret"></span></button>
				<button type="button" class="img_select icon-hlighter-width"><i>굵기</i><span
						class="caret"></span></button>
				<!-- 형광펜 색상 선택 -->
				<div class="select_hlighter_color_wrap">
					<button type="button" class="hlighter_palette" data-hlighterColor="#000000"><i
							style="background:#000000">색상1</i></button>
					<button type="button" class="hlighter_palette" data-hlighterColor="#ffffff"><i
							style="background:#fff; border-color:#d5d5d5">색상2</i></button>
					<button type="button" class="hlighter_palette active" data-hlighterColor="#f24545"><i
							style="background:#f24545">색상3</i></button>
					<button type="button" class="hlighter_palette" data-hlighterColor="#ff3be5"><i
							style="background:#ff3be5">색상4</i></button>
					<button type="button" class="hlighter_palette" data-hlighterColor="#2432cc"><i
							style="background:#2432cc">색상5</i></button>
					<button type="button" class="hlighter_palette" data-hlighterColor="#4090f3"><i
							style="background:#4090f3">색상6</i></button>
					<button type="button" class="hlighter_palette" data-hlighterColor="#4aedff"><i
							style="background:#4aedff">색상7</i></button>
					<button type="button" class="hlighter_palette" data-hlighterColor="#51e37f"><i
							style="background:#51e37f">색상8</i></button>
					<button type="button" class="hlighter_palette" data-hlighterColor="#ffd342"><i
							style="background:#ffd342">색상9</i></button>
				</div>
				<!-- 형광펜 굵기 -->
				<div class="select_hlighter_width_wrap">
					<div class="select_h_w select_hlighter_width_1" data-hlighterWidth=12></div>
					<div class="select_h_w select_hlighter_width_2" data-hlighterWidth=18></div>
					<div class="select_h_w select_hlighter_width_3" data-hlighterWidth=24></div>
				</div>
			</div>
			<!-- 스티커 보조창 -->
			<div class="sticker_wrap">
				<button type="button" class="sticker_select icon-sticker_1" data-sticker="sticker_1"><i>매우
						강조</i></button>
				<button type="button" class="sticker_select icon-sticker_2" data-sticker="sticker_2"><i>강조</i></button>
				<button type="button" class="sticker_select icon-sticker_3"
					data-sticker="sticker_3"><i>필기영역</i></button>
				<button type="button" class="sticker_select icon-sticker_4"
					data-sticker="sticker_4"><i>주의하기</i></button>
				<button type="button" class="sticker_select icon-sticker_5"
					data-sticker="sticker_5"><i>기억하기</i></button>
				<button type="button" class="sticker_select icon-sticker_6" data-sticker="sticker_6"><i>참
						잘했어요</i></button>
			</div>
		</div>
		<div>
			<button type="button" class="icon-drawing4" title="지우개">지우개</button>
			<button type="button" class="icon-drawing5" title="삭제">되돌리기</button>
		</div>
		<div>
			<button type="button" class="icon-drawing6" title="안보이게 하기">안보이게 하기</button>
		</div>
		<div>
			<button type="button" class="icon-drawing7" data-toggle="show" data-target="#drawing">닫기</button>
		</div>
	</div>

	<!-- 계산기 -->
	<div id="calculator_wrap" draggable="true" tabindex="0">
		<div id="the-calculator">
			<div id="calc_close"></div>
			<div class="calc_wrap">
				<div id="the-display">
					<div class="calc_history show_history">

					</div>
					<div class="show_display">
						<div id="math_input" class="result"> </div>
						<div id="total" class="screen"><span id="screentext" class="screentext animated"></div>
					</div>
				</div>
				<div id="the-buttons">
					<div class="button-row clearfix">
						<button id="cbac" class="cbac">C</button>
						<button id="calc_neg" class="etc_button cbpar" key='('>(</button>
						<button id="calc_neg" class="etc_button cbpar" key=')'>)</button>
						<button id="calc_eval" class="etc_button enter">=</button>
					</div>
					<div class="button-row clearfix">
						<button class="calc_int cbnum" key="7">7</button>
						<button class="calc_int cbnum" key="8">8</button>
						<button class="calc_int cbnum" key="9">9</button>
						<button class="calc_op etc_button cbop operands" key='/' char='÷'>&divide;</button>

					</div>
					<div class="button-row clearfix">
						<button class="calc_int cbnum" key="4">4</button>
						<button class="calc_int cbnum" key="5">5</button>
						<button class="calc_int cbnum" key="6">6</button>
						<button class="calc_op etc_button cbop operands" key='*' char='×'>&times;</button>

					</div>
					<div class="button-row clearfix">
						<button class="calc_int cbnum" key='1'>1</button>
						<button class="calc_int cbnum" key="2">2</button>
						<button class="calc_int cbnum" key="3">3</button>
						<button class="calc_op etc_button cbop operands" key='-' char='-'>-</button>
					</div>
					<div class="button-row clearfix">
						<button id="calc_zero" class="calc_int cbnum" key="0">0</button>
						<button id="calc_decimal" class="cbnum" key='.'>.</button>
						<button id="calc_back" class="cbce">&larr;</button>
						<button class="calc_op etc_button cbop operands" key='+' char='+'>+</button>
					</div>
				</div>
			</div>
			<div class="result_wrap">
				<ul>
				</ul>
			</div>
		</div>
	</div>

	<form name="iframe_board_send_data" id="iframe_board_send_data">
		<input type="hidden" id="ibsd_plying_id" name="plying_id" value="" />
		<input type="hidden" id="ibsd_playlist" name="playlist" value="" />
		<input type="hidden" id="ibsd_user_id" name="user_id" value="" />
		<input type="hidden" id="ibsd_thumbnail" name="thumbnail" value="" />
		<input type="hidden" id="ibsd_playlist_title" name="playlist_title" value="" />
		<input type="hidden" id="ibsd_info_title" name="info_title" value="" />
		<input type="hidden" id="ibsd_page" name="page" value="" />
		<input type="hidden" id="ibsd_mode" name="mode" value="" />
	</form>
	<script
		src="https://polyfill.io/v3/polyfill.min.js?features=Promise%2CString.prototype.padStart%2CString.prototype.startsWith"></script>
	<!-- <script src="js/promise-polyfill.min.js"></script> -->

	<script src="https://cdnjs.cloudflare.com/ajax/libs/konva/7.2.0/konva.min.js"
		integrity="sha512-Z2K1QFLdmTUdZk7W1h65BOeap9JojncX3j4KZ3Z/oQTZGG/Jg4BNZPEFVIhAU6ovf76w1ebLZJM91Eb4W5867Q=="
		crossorigin="anonymous"></script>
	<script src="js/viewer.drawingcanvas.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/2.6.0/math.min.js"></script>
	<script src="js/jquery.min.js"></script>
	<!--<script src="http://boinitdev.iptime.org:10000/socket.io/socket.io.js"></script>-->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<script src="js/jquery.ui.touch-punch.min.js"></script>
	<!-- <script src="js/e-smart-zoom-jquery.min.js"></script> -->
	<script src="js/e-smart-zoom-jquery.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/videojs-ie8.min.js"></script>
	<script src="js/video.js"></script>
	<script src="js/Youtube.min.js"></script>
	<script src="js/videojs-playlist.js"></script>
	<script src="js/viewer.module.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/mobile-detect/1.4.4/mobile-detect.min.js"
		integrity="sha512-hSVyGuXBHmZy+A+P21DRUAuc7UTfcqc0geieb/H1ZmqiJAoDTfzFYIOBAMTcFUWU/PwLPEoREYG/77ckPB6oSw=="
		crossorigin="anonymous"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"></script>
	<script src="js/viewer.layout.js"></script>
	<!-- <script src="js/viewer/viewer.js"></script> -->
	<script src="https://cdn.jsdelivr.net/npm/underscore@1.11.0/underscore.min.js"></script>

	<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"
		integrity="sha256-xoh0y6ov0WULfXcLMoaA6nZfszdgI8w2CEJ/3k8NBIE=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/fullscreen.js@0.2.5/dist/fullscreen.min.js"
		integrity="sha256-pec3tu9/8wJJU3SPl3M8OKKCA0m9FYFMVgU0cF92yxw=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/jquery-toast@1.0.0/jquery.toast.js"
		integrity="sha256-rI2yKVJ5ZaS9P5C1SmeVechb9vzKH/JrK2OL+/cF6qo=" crossorigin="anonymous"></script>

	<script src="https://cdn.jsdelivr.net/npm/vex-js@4.1.0/dist/js/vex.combined.js"
		integrity="sha256-LSKMfbhy3vEb686cTq5ITGkNtRMQ9DocDnlAAn291p0=" crossorigin="anonymous"></script>
	<script>vex.defaultOptions.className = 'vex-theme-default';</script>

	<script src="./jquery.getSelector.js"></script>
	<script src="./utils.js"></script>
	<script src="./tms.js"></script>
	<script src="./viewer.1.js"></script>
	<script src="./viewer.drawing_save_load.js"></script>
	<script src="./mirroring.js"></script>
	<script src="./app.js"></script>
	<script src="./v.drawing.js"></script>
	<script src="./v.preview.js"></script>
	<script src="./v.ebook.js"></script>
	<script src="./v.calculator.js"></script>

	<script>

		$(document).ready(function () {
			$.LoadingOverlaySetup({
				image: "/assets/viewer/img/viewer/loading.svg",
				imageAnimation: false,
				imageAutoResize: true,
				imageResizeFactor: 1,
				textColor: "#006c45",
			});
			//$.LoadingOverlay("show");

			detect_mobile_device_type();
			$('body').attr('device', DEVICE_TYPE);

			var theme = "default";
			var cookie_theme = getCookie('theme');
			if (["default", "theme-dark-2", "theme-green"].includes(cookie_theme)) {
				theme = cookie_theme;
			}
			$('body').attr('theme', theme);
		});

		$(document).on('click', '#mirroring-start a.button', function (e) {

			if (!parent || !parent.opener || !parent.opener.viewer) {
				alert('올바르지 않은 호출입니다. 미러링을 다시 시작해주세요.');
				window.close();
				return;
			}

			$.LoadingOverlay("show");

			$("#mirroring-start").hide();
			$("#viewer-content").show();

			if (!TEST_LOCALHOST) {
				window.moveTo(0, 0);
				window.resizeTo(screen.width, screen.height);
			}
			viewer.sync_with_parent();

			ebook.get_unit_data(viewer._playlist_data);
		});

		$(document).on("click", ".popup.tools a.close", function (e) {
			app.close_popup_content();
			mirroring.api_sync_obj({
				target: "app",
				script: "app.close_popup_content();"
			});
		});

		$(document).on("click", "#page > button.icon-prev, .icon-prev-content", function (e) {
			var obj = viewer.get_prev();
			if (!obj) {
				return;
			}
			app.move_to_subject_by_id(obj.id, obj.type);
			mirroring.api_sync_obj({
				target: "app",
				script: "app.move_to_subject_by_id('" + obj.id + "', '" + obj.type + "');"
			});
		});
		$(document).on("click", "#page > button.icon-next, .icon-next-content", function (e) {
			var obj = viewer.get_next();
			if (!obj) {
				return;
			}
			app.move_to_subject_by_id(obj.id, obj.type);
			mirroring.api_sync_obj({
				target: "app",
				script: "app.move_to_subject_by_id('" + obj.id + "', '" + obj.type + "');"
			});
		});
		$('#module-modal').on('shown.bs.modal', function () {
			// console.error("#module-modal on.shown.bs.modal");
			$("#drawing-button").removeClass('active');
			$("#drawing").removeClass('active');
			if (iframe_canvas) {
				iframe_canvas.deactivate();
			}
			console.log("hide drawing canvas");
			$(".drawing-canvas-wrapper").addClass('hidden');
		});


		// $('#module-modal').on('hidden.bs.modal', function () {
		// 	console.log('mirror hidden');

		// 	// console.error("#module-modal on.hidden.bs.modal");
		// 	on_hidden_module_modal();
		// 	mirroring.api_sync_obj({
		// 		target: "app",
		// 		script: "on_hidden_module_modal();"
		// 	});
		// 	return false;
		// });

		$(document).on('click', '#module-modal .close', function () {
			on_hidden_module_modal();

			mirroring.api_sync_obj({
				target: "app",
				script: "on_hidden_module_modal();"
			});
		});

		$(document).on("click", ".carousel-control-prev", function (e) {
			if (IS_USING_PDF_MODULE) {
				$("#pdf-iframe").get(0).contentWindow.pdfPrev();
			} else {
				Module.image_viewer.control_prev();
			}
		});
		$(document).on("click", ".carousel-control-next", function (e) {
			if (IS_USING_PDF_MODULE) {
				$("#pdf-iframe").get(0).contentWindow.pdfNext();
			} else {
				Module.image_viewer.control_next();
			}
		});
		$(window).on("resize", function (e) {
			viewer.resize();
			viewer.play_list_fit_height(true);
			if (IS_USING_PDF_MODULE) {
				try {
					$("#pdf-iframe").get(0).contentWindow.pdfFit();
				} catch (error) {
					console.error(error);
				}
			}
		});
		// 계산기 드래그
		$(document).on('drag', '#calculator_wrap', function () {
			var _left = parseFloat($(this).css('left'));
			var _top = parseFloat($(this).css('top'));

			mirroring.api_sync_obj({
				target: "viewer",
				script: 'viewer.mirroringCalcDrag(' + _left + ', ' + _top + ');'
			});
		});
		// ebook title click event
		$(document).on('click', '.popup.tools #double', function () {
			if ($(this).hasClass('active')) {
				return;
			};

			$(this).addClass('active');
			$('.popup.tools #single').removeClass('active');

			if ($('#math-tool').hasClass('active')) {
				$('#math-tool .icon-drawing7').click();
			};

			ebook.status_single_to_double();

			mirroring.api_sync_obj({
				target: "viewer",
				script: "$('.popup.tools #double').click();"
			});
		});
		// ebook 닫기
		$(document).on('click', '.popup.tools .close, #page_list li.subject', function () {
			// ebook move button hide
			ebook.move_button_hide();

			if ($("#math-tool").hasClass('active')) {
				$("#math-tool").removeClass('active');
				$("#math_tool_btn").removeClass('active');
			};
			// 교과서 볼 때는 안 보이도록 한 것을 다시 보이도록 변경
			$('.icon-aside-open-txt').css('display', 'block');
			$('#module-modal').css('display', 'none');
			$('#iframe_content_pairbook').css('display', 'none');
			// $('#math-tool #math-tool-4').parent().show();

			mirroring.api_sync_obj({
				target: "ebook",
				script: "ebook.move_button_hide();"
			});
		});
		$(document).on('click', '.popup.tools #single', function () {
			if ($(this).hasClass('active')) {
				return;
			};

			$(this).addClass('active');
			$('.popup.tools #double').removeClass('active');

			if ($('#math-tool').hasClass('active')) {
				$('#math-tool .icon-drawing7').click();
			};

			ebook.status_double_to_single();

			mirroring.api_sync_obj({
				target: "viewer",
				script: "$('.popup.tools #single').click();"
			});
		});
		// 한쪽 보기 가로폭/세로폭 클릭
		$(document).on("click", ".popup.tools .content_viewType", function () {
			ebook.viewTypeIconChange();

			mirroring.api_sync_obj({
				target: "ebook",
				script: "ebook.viewTypeIconChange();"
			});

			ebook.singlePageFit();

			mirroring.api_sync_obj({
				target: "ebook",
				script: "ebook.singlePageFit();"
			});
		});

		(function () {
			window.onmessage = function (e) {

				console.log('**************************************')
				console.log(e)
				console.log('**************************************')

				// console.log(e)
				if (e.data == 'ebook_link_click') {
					var get_data = viewer._playing;
					console.log(viewer)
					/**
					 * page 정보는 조합해야 함.
					 *
					 * 시작 페이지는 playlist에 있는 page정보이고
					 * 종료 페이지는
					 *  - studybook : viewer._playlist_data.info.studybook_pages
					 *  - ebook : viewer._playlist_data.info.ebook_pages
					 */
					var page = undefined;
					var _book_type = get_data.ebook_type;

					// 시작 페이지 - studybook과 ebook 공통
					var dataPage = get_data.page;
					var _startPage = undefined;

					dataPage.indexOf('~') != -1 ?
						_startPage = dataPage.split('~')[0]
						: _startPage = dataPage;

					// 종료 페이지는 ebook_type에 따라 다름
					if (_book_type == 'ebook') {
						var getViewerData = viewer._playlist_data.info.ebook_pages;
						var _endPage = undefined;

						getViewerData.indexOf('~') != -1 ?
							_endPage = getViewerData.split('~')[1]
							: _endPage = getViewerData;

						if (_startPage == _endPage) {
							page = _startPage;
						} else {
							page = _startPage + '~' + _endPage;
						}
					} else if (_book_type == 'studybook') {
						var getViewerData = viewer._playlist_data.info.studybook_pages;
						var _endPage = undefined;

						getViewerData.indexOf('~') != -1 ?
							_endPage = getViewerData.split('~')[1]
							: _endPage = getViewerData;

						if (_startPage == _endPage) {
							page = _startPage;
						} else {
							page = _startPage + '~' + _endPage;
						}
					}

					var this_page = get_data.page;
					var this_type = viewer._playlist_data.info.type;

					var send_page = { 'page': page, 'type': this_type, 'ebook_type': _book_type, 'this_page': this_page };

					console.log('send_page');
					console.log(send_page);

					viewer.showEbook(send_page);

					if ($("#math-tool").hasClass('active')) {
						$("#math-tool").removeClass('active');
						$("#math_tool_btn").removeClass('active');
					}

					mirroring.api_sync_obj({
						target: "viewer",
						script: "viewer.showEbook({'page' : '" + page + "', 'type' : '" + this_type + "', 'ebook_type' : '" + _book_type + "', 'this_page' : '" + this_page + "'});"
					});
				};
			};

		})();
	</script>
</body>

</html>